# 2. 리팩터링 원칙

### 리펙터링은 동작을 보존하는 작은 단계들을 거쳐 코드를 수정하고, 이러한 단계들을 순차적으로 연결하여 큰 변화를 만들어내는 일이다.

* 리펙터링은 성능 최적화와 비슷하다. 코드를 변경하지만 프로그램 전반적인 기능은 그대로 유지한다.
* 목적은 코드를 이해하고 수정하기 쉽게 만드는 것

### 기능추가, 리펙터링 두가자의 목적성을 확실히 구분할 것

* 기능추가가 목적이면 확실히 기능추가만 한다
* 리펙터링이 목적이면 기능추가는 절대 하지말고 코드 재구성에만 전념
* 분명 작업 시에 두가지가 혼합될 수 있지만, 그 목적성을 염두해두고 항상 작업하라

### 언제 리펙터링을 해야할까?

1. 처음에는 그냥 코드를 작성한다
2. 비슷한 일을 두번째로 하게되면, 일단 계속 진행한다.
3. 비극한 일은 세번째 하게 되면 리펙터링한다.

리펙터링은 기능을 추가하거나 버그를 잡거나 할 때 자연스럽게 한다. 따로 일정을 잡고 하지 않는다. 습관처럼 몸에 배어있어야 한다

* 일부를 변경해도 모든 기능이 항상 올바르게 작동해야한다
* 예를들어 라이브러리를 교체할 때는 기존 것과 새것 모두를 포용하는 추상 인터페이스부터 마련한다
* 기존코드가 이 추상 인터페이스를 호출하도록 만들고 나면 라이브러리를 휠씬 더 쉽게 교체할 수 있다

### 코드리뷰에 리팩터링 활용

* 코드리뷰는 개발팀 전체에 지식을 전파하는 데 좋다
* 자신이 하는 일에 익숙하지 않은 사람의 관점에서 바라보기란 누구에게나 어렵기 때문
* 리팩터링을 하면 소프트웨어를 빠르게 만드는게 효과적이다

### 리팩터링을 하지 말아야 할 때

* 지저분한 코드를 반견해도 굳이 수정할 필요가 없다면 리팩터링하지 않는다
* 외부API 다루듯 호출해서 쓰는 코드라면 지저분해도 그냥 둔다
* 리팩터링하는 것보다 처음부터 새로 작성하는 게 쉬울 때도 하지 않는다

### 새기능 개발 속도 저하

* 리팩터링의 목적은 개발 속도를 높여서. 더 적은 노력으로 더 많은 가치를 창출하는 것이다
* 건강한 코드의 위력을 충분히 경험해 보지 않고서는 생산성의 차이를 경험하기 쉽지 않다
* 리팩터링은 코드를 이쁘게 꾸미는게 아니라 오로지 경제적인 이유로 존재한다
* 기능추가 시간을 줄이고, 버그 수정 시간을 줄여준다

### 레거시 코드

* 레거시 시스템을 파악할 때 리팩터링이 굉장히 도움이 된다
* 레거시에 테스트 코드가 있다면 리팩터링하기 좋지만 없어도 문제를 해결하기 위해서라면 감내할 수 있겠다
* 그래서 더욱이 처음 작성하는 코드는 테스트 코드를 작성하는것이 좋다
