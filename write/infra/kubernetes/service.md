# Service란?

서비스(Service) 는 클러스터 내에서 실행 중인 **Pod**를 네트워크를 통해 접근 가능하도록 만들어 주는 추상화된 리소스이다.

비스는 Pod의 생명 주기와 독립적으로 동작하며, 이를 통해 여러 Pod에 안정적인 네트워크 연결을 제공한다.

<figure><img src="../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

### 서비스의 주요 개념

1. **Pod와의 연결**:
   * 쿠버네티스 클러스터에서 Pod는 언제든지 생성되거나 삭제될 수 있다.&#x20;
   * Pod는 클러스터 내에서 동적으로 IP 주소를 할당받기 때문에, Pod에 직접적으로 접근하려면 어려움이 따르는데, 서비스는 이러한 문제를 해결해 준다.
   * 서비스는 selector를 사용하여 특정 레이블(label)을 가진 Pod를 자동으로 선택하고, 그들 간의 네트워크 트래픽을 분배한다
2. **고정된 IP 제공**:
   * 서비스는 `ClusterIP`라는 고정된 IP 주소를 제공한다. 이 IP 주소는 클러스터 내에서 지속적으로 사용되며, Pod가 변경되더라도 서비스의 IP는 변하지 않는다.
3. **로드 밸런싱**:
   * 서비스는 여러 Pod에 대한 트래픽을 로드 밸런싱할 수 있다. 서비스 뒤에 여러 Pod가 있는 경우, 서비스는 클라이언트 요청을 각각의 Pod에 균등하게 분배한다.

### 서비스의 종류

1. **ClusterIP** (기본값):
   * 쿠버네티스 클러스터 내부에서만 접근 가능한 서비스이다.&#x20;
   * 클러스터 내에서 특정 서비스에 연결할 수 있도록 고정된 IP를 제공한다.
2. **NodePort**:
   * 클러스터 외부에서 접근할 수 있도록 각 노드의 특정 포트를 통해 서비스를 노출한다.&#x20;
   * 외부 클라이언트는 `NodeIP:NodePort`를 통해 서비스에 접근할 수 있다.
3. **LoadBalancer**:
   * 클라우드 환경에서 주로 사용되며, 클라우드 제공자의 로드 밸런서를 통해 외부 트래픽을 서비스로 라우팅한다. &#x20;
   * LoadBalancer는 외부에 공용 IP 주소를 할당하여 외부 클라이언트가 직접 접근할 수 있게 한다.
4. **ExternalName**:
   * 클러스터 외부에 있는 서비스를 클러스터 내부에서 사용 가능한 DNS 이름으로 매핑.&#x20;
   * 외부 서비스의 DNS 이름을 설정하여 내부 Pod들이 해당 서비스를 호출할 수 있게 한다.
5. **Headless Service**:
   * `ClusterIP` 없이 서비스가 제공되고각 Pod에 직접 접근할 수 있도록 DNS 이름을 제공&#x20;
   * 보통 상태가 있는 애플리케이션(StatefulSet)에서 사용되며, Pod의 IP를 직접 노출한다

### 서비스와 관련된 구성 요소

* **Selector**: 서비스는 특정 레이블을 가진 Pod를 선택. 이 레이블 셀렉터를 통해 서비스가 어떤 Pod에 트래픽을 라우팅할지를 결정한다
* **Endpoints**: 선택된 Pod의 IP와 포트 정보를 담고 있는 객체, 서비스가 트래픽을 라우팅할 때 이 엔드포인트 정보를 사용한다.
* **kube-proxy**: 클러스터 내의 각 노드에서 실행되며, 서비스의 네트워크 규칙을 설정하여 트래픽을 적절한 Pod로 전달한다.
